const api={base:(localStorage.getItem('api_base')||'http://127.0.0.1:8000'),token:localStorage.getItem('token')||null,setToken(t){this.token=t;localStorage.setItem('token',t)},headers(){const h={'Content-Type':'application/json'};if(this.token){h['Authorization']='Bearer '+this.token}return h},async get(p){const r=await fetch(this.base+p,{headers:this.headers()});if(!r.ok)throw new Error(await r.text());return r.json()},async post(p,b){const r=await fetch(this.base+p,{method:'POST',headers:this.headers(),body:JSON.stringify(b)});if(!r.ok)throw new Error(await r.text());return r.json()}};window.api=api;